# 08 玩法界面与操控模式（参考 Noita/魔法工艺）

## 8.1 整体界面布局（参考 Noita）
### 8.1.1 屏幕布局
- **游戏区域**：占据屏幕大部分，俯视角 2D 战斗场景
- **左侧面板**：法术编辑器（类似 Noita 的魔杖编辑界面）
  - 当前装备的魔杖/武器
  - 法术模板选择
  - 模块顺序重排（拖拽）
  - 档位选择（下拉）
- **右侧/底部 HUD**：
  - 玩家 HP/Mana 条（参考 Noita）
  - 当前法术预览（指示器形状/范围）
  - 掉落提示（参考 Noita 的掉落显示）
  - 击杀统计（可选）

### 8.1.2 编辑器界面（参考 Noita 的魔杖编辑）
- **模块链显示**：水平或垂直排列的模块卡片
- **拖拽重排**：鼠标拖拽模块卡片调整顺序
- **档位切换**：点击模块卡片展开档位选择
- **实时预览**：显示当前 Assembly 的预算、施法体验摘要（前摇/弹速/范围）

## 8.2 操控模式（参考 Noita）
### 8.2.1 基础操控
- **WASD**：八方向移动（参考 Noita 的流畅走位）
- **鼠标移动**：实时瞄准方向（参考 Noita 的鼠标瞄准）
- **左键按住**：连续施法（参考 Noita 的按住连发机制）
- **右键**：副法术（可选）
- **Space**：翻滚/闪避（参考 Noita，带短暂无敌帧）

### 8.2.2 施法机制（参考 Noita）
- **按住左键**：持续施法，每次施法有前摇+后摇（充能时间）
- **前摇期间**：可移动但降速，显示指示器预览
- **后摇期间**：可移动但不可再次施法（充能中）
- **资源不足**：施法失败，UI 提示（参考 Noita 的充能不足提示）

### 8.2.3 战斗节奏（参考 Noita）
- **走位优先**：玩家需要不断移动躲避怪物攻击
- **时机把握**：前摇/后摇限制施法频率，需要把握时机
- **资源管理**：Mana 消耗与回复，需要合理分配
- **模块顺序影响节奏**：例如“先充能再投射”vs“先投射再充能”影响施法频率

## 8.3 视觉风格（参考 Noita/魔法工艺）
### 8.3.1 整体风格
- **俯视角 2D**：像素风或简化几何体（本阶段可简化）
- **高对比度**：玩家/怪物/投射物/指示器颜色区分明显
- **粒子效果**：命中/爆炸/死亡用简单粒子表达（参考 Noita）

### 8.3.2 UI 风格（参考 Noita）
- **简洁实用**：信息密度适中，不遮挡战斗区域
- **实时反馈**：伤害数字、资源条、冷却提示
- **编辑器可折叠**：战斗时可收起编辑器面板，专注战斗

## 8.4 与 ECA 系统的对接
### 8.4.1 操控输入 → ECA 事件
- **左键按下**：触发 `CastConfirm` 事件（带瞄准方向）
- **右键按下**：触发副法术的 `CastConfirm`（可选）
- **移动输入**：影响玩家位置，间接影响目标选择与距离判定

### 8.4.2 表现反馈 ← ECA 执行
- **OnCastWindupStart**：显示指示器、播放前摇动画
- **OnCastRelease**：生成投射物表现、播放释放音效
- **OnHitConfirmed**：命中闪光、伤害数字、屏幕震动
- **OnKill**：死亡特效、掉落弹出

## 8.5 与 Noita/魔法工艺的差异点
### 8.5.1 与 Noita 的差异
- **模块重复**：Noita 允许同一法术重复多次，本设计采用“每个模块只出现一次，但顺序可重排”
- **魔杖属性**：Noita 有充能时间/施法延迟等魔杖固有属性，本设计用 Template 的 guards 表达
- **法术收集**：Noita 通过探索收集法术，本设计通过 PVE 掉落模块碎片解锁档位

### 8.5.2 与魔法工艺的差异
- **模块类型**：魔法工艺有“触发/效果/修饰”等类型，本设计用 Condition/Target/Action/Timeline
- **组合自由度**：魔法工艺允许更自由的模块组合，本设计限制在 Template 的固定集合内
- **表现复杂度**：魔法工艺有更复杂的视觉效果，本设计采用简化表现以验证核心玩法
