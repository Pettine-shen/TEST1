# 05 PVE 验证：怪物体系、掉落与验证方法

## 验证目标
本阶段 PVE 验证的成功标准：
- **可玩**：玩家能在 30 秒内稳定击杀一波怪（不会秒躺/也不会完全无压力）。
- **可差异**：同一模板不同顺序能表现出明显差异（击杀速度、玩家剩余血量、掉落触发稳定性）。
- **可观测**：输出清晰的统计（剩余怪物数、掉落、玩家 HP、关键触发次数）。

## 怪物体系（最小可用）
### 三类原型
1) **MeleeGrunt（近战杂兵）**
- 特征：血量中等、追击快、近战攻击
- 作用：测试近战命中、控制与抗压能力

2) **RangedShooter（远程小怪）**
- 特征：血量较低、射程较远、移动较慢
- 作用：测试远程模板的清场与目标选择（单体 vs AOE）

3) **EliteBrute（精英）**
- 特征：血厚、防高、伤害高、移动慢
- 作用：测试持续输出、印记收割、DoT 与反击的价值

（当前实现配置见：`configs/monsters.js`）

### AI（简化）
- 若距离 > 射程：向玩家移动（直线）
- 若距离 <= 射程：按攻击冷却出手（默认 1000ms 一次）

关键点：必须有 **攻击冷却**，否则模拟 tick 过密会导致玩家瞬间被打死，无法验证技能差异。

## 掉落体系（最小可用）
### 掉落表
（当前实现见：`configs/drops.js`）
- common：常见碎片、低级催化剂
- elite：含稀有碎片、中级催化剂
- pve_bonus：奖励表（用于“印记击杀掉落加成”验证）

### 经济动作（PVE Only）
本阶段允许“标记→击杀→掉落加成”的验证，但必须满足：
- 掉落内容来自服务器/配置表（不是玩家直接定义）
- 只依赖可校验条件（例如目标带印记 tag）

## 验证场景（推荐）
### 场景 A：标准混编波次（默认）
- 4 近战 + 2 远程 + 1 精英
- 目标：30 秒内清空

### 场景 B：纯远程压力
- 6 远程
- 目标：对比 Target 前置/后置对命中与清怪效率的影响

### 场景 C：精英单挑
- 1 精英
- 目标：观察 DoT、印记与反击在“长战斗”中的稳定性

## 指标（Metrics）
### 战斗结果
- `RemainingMonsters`
- `PlayerHP`
- `DropsCollected`（以及奖励表触发次数）

### 过程指标（建议后续补齐）
- 每个模板触发次数（CastConfirm/OnDamaged）
- 每个 op 执行次数（Condition/Action/Target/Timeline）
- 平均命中目标数（AOE 有效性）

## 如何判断“顺序确实改变了玩法”
建议在同一模板下做两种顺序对比，观察：
- 清怪速度与稳定性差异（是否更容易把怪控在射程外/更容易集火）
- 同等预算下“收益实现方式”变化（先控后打 vs 先打后控）
- 对标记收割模板：把 `Mark` 前置 vs 后置，应当显著影响奖励触发概率

## 与当前代码的对应关系
- CLI 模拟：`sim/simulation.js`
- 浏览器试玩：`editor/play.js`
- 怪物与掉落配置：`configs/monsters.js`、`configs/drops.js`

